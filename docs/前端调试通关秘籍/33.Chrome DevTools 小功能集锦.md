# 33.Chrome DevTools 小功能集锦

Chrome DevTools 有很多有用的小功能，这节就专门梳理一下这个：

## reply XHR

当你想重新发送一次 XHR 请求的时候，不用刷新页面，直接点击 replay XHR 即可：

![](./images/fe791bd55791ffff1369c62a2b82d586.webp )

## 请求定位到源码

当你想知道某个请求是在哪里发的，可以打开 Network 面板，在每个网络请求的 initiator 部分可以看到发请求代码的调用栈，点击可以快速定位到对应代码。


![image.png](./images/bcc900f662bb1f082d790e3a46682ef6.webp )

## 元素定位到创建的源码

当你想知道某个元素的创建流程，可以通过 Elements 面板选中某个元素，点击 Stack Trace，就会展示出元素创建流程的调用栈。这可以帮你理清前端框架的运行流程。

![](./images/df9d3a7d74ae9a818645737fd9ae44df.webp )

这个功能是实验性的，需要手动开启下：在 settings 的 expriments 功能里，勾选 “Capture node creation stacks”。

![](./images/f8c04f998d4e517fe3435fa3b040551c.webp )

## group by folder

网页加载的文件默认是按照域名和目录组织的，找文件时一层层找起来比较麻烦。

这时候可以切换为平铺的，会按照 js、css、图片的顺序列出来，找某个文件就容易多了：

![](./images/43a23fb8e6af5d8e3ae0bf6b8ec7a606.webp )

## Network 自定义展示列

Network 是可以修改展示的列的，比如我勾选 Cookie 和 Set-Cookie：

![](./images/fd8554200c4cf08a93cacb429bfec0aa.webp )

就会在 Network 列表里展示这两列：

![](./images/18eb35753dec77b84edb2867e5312fbf.webp )

这两列啥意思呢？

Set-Cookie 的意思就是这个请求的响应会设置几个 cookie。

点开请求的详情确实是这样的：

![](./images/3994417646a5d99434bb30524b65190a.webp )

Cookies 的意思就是说这个请求会携带几个 cookie：

比如那个携带 17 个 cookie 的请求：

![](./images/23e84067c93bd59f06c031262305e75b.webp )

不用数，肯定是 17 个。

除此以外，你还可以自定义展示的响应 header：

![](./images/18d9f7bd20b3321677b603f937f5a575.webp )

![](./images/1efbe055c79d1e5247c655396ee71839.webp )

我比较常用的是 Cache Control：

![](./images/1c4afca87d716969d304ddcc01c4f9dd.webp )

可以快速查看每个文件的缓存策略：

![](./images/3a3cf56e3a41ddcd87beb419e68b1f6e.webp )

请求列表右边有个 waterfall，默认是展示请求的时间，但我觉得这个没啥用，我更喜欢看请求响应的耗时：

![](./images/a6c1c6b025180452e8a0d3f1dd0202c7.webp )

所以我会把它换成 total duration：

![](./images/4a467ed76264f68bcb02cc0868b75fff.webp )

这样 waterfall 展示的就是耗时了：

![](./images/b779ea3b709d2e67388fff8bbd290dd2.webp )

可以直观的看到请求的耗时，还可以排序。我觉得这个数据有用的多。

## 代码手动关联 sourcemap

sources 面板可以右键点击 add soruce map，输入 sourcemap 的 url 就可以关联上 sourcemap，当调试线上代码的时候可以用这种方式关联源码。

![](./images/605df5f246ab02d18d547b7cf9de98c0.webp )

## filter

一个网站会有很多的请求，当你想查找某个请求的时候，是怎么过滤的呢？

关键词搜索么？

但是关键词搜索只能根据 url 来过滤。

很多时候这样不太够。

比如我想搜索视频类型的请求，根据 url 怎么过滤？比如我想搜索大于 1M 的请求，根据 url 怎么过滤？

这时候就可以用过滤器功能了。

输入 mime-type，加个冒号，Chrome DevTools 就会列出当前网页的请求的所有 mime type，选择某一种，就会过滤出那种 mime type 的请求。

比如过滤 mp4 请求：

![](./images/62daee025cac9ebfda4d4d81371aac5a.webp )

过滤 webp 请求：

![](./images/c2064bf277e00f56493bb5a42c62ad60.webp )

或者不根据 mime-type，根据资源的大致分类来过滤：

输入 resource-type，加个冒号或者按右方向键，会展示出所有的资源分类，包括 document、stylesheet、image 等：

![](./images/5c4ae6cd85d266f30cf6586973c6c79e.webp )

其实这就是 Network 的这部分：

![](./images/104b841bc3ad17e2c37ffc741ffac3c9.webp )

而且还可以按住 command 键多选。

除了资源类型外，还可以根据状态码过滤：

![](./images/9b480909b6eec5a7150c4b0bc9935280.webp )

比如 200、404、500 等，只是我测试的这个页面没有 404 之类的请求。

状态码 0 代表被删除或取消的请求，网络请求是可以被取消的，这种就可以通过状态码 0 来过滤。

此外还可以根据资源的大小来过滤：

通过 larger-than 指定 100、300k、2M 等大小的限制，就可以过滤出大小大于这个值的请求。

![](./images/54b03cfd27974df1a3d712576a121323.webp )

还可以根据请求方式，是 GET、POST 等来过滤：

![](./images/be260a43b94975315c29851bcf342513.webp )

根据是否包含某个响应 header 来过滤：

![](./images/32345421ecb8a53e366331fb5031ece1.webp )

has-response-header:Set-Cookie 过滤出来的就是有设置 cookie 的响应的请求

has-response-header:access-control-allow-origin 过滤出来的就是支持跨域的请求

根据是否包含某个 cookie 来过滤：

![](./images/ab7fd634a6928d781e7a825cb24de65f.webp )

常用的过滤器主要有这些：

- has-response-header：过滤响应包含某个 header 的请求

- method：根据 GET、POST 等请求方式过滤请求

- domain: 根据域名过滤

- status-code：过滤响应码是 xxx 的请求，比如 404、500 等

- larger-than：过滤大小超过多少的请求，比如 100k，1M

- mime-type：过滤某种 mime 类型的请求，比如 png、mp4、json、html 等

- is：过滤某种状态的请求，比如 from cache 从缓存拿的，比如 running 还在运行的

- resource-type：根据请求分类来过滤，比如 document 文档请求，stylesheet 样式请求、fetch 请求，xhr 请求，preflight 预检请求

- cookie-name：过滤带有某个名字的 cookie 的请求

当然，这些不需要记，输入一个 - 就会提示所有的过滤器：

![](./images/0da9e5ddd2a2a5eaa6a9c8e04080b355.webp )

但是这个减号之后要去掉，它是非的意思：

![](./images/07dd83853ff4b57e074152e59a9f1af4.webp )

和右边的 invert 选项功能一样。

而且，这些过滤器都可以组合，只要中间加个空格就行。

但是有同学会问了，这些过滤器里好像不支持根据内容过滤呀。

确实，过滤器不支持这个，但是可以自己搜：

![](./images/b9552db9256b26a1c429e27f9bf3fd18.webp )

## developer resources

看到 sourcemap 有的同学可能会问，对了，sourcemap 文件为啥在 Network 里看不到呢？

明明会下载 sourcemap 文件，为啥我从来没看到过呢？

其实这个被 Network 过滤掉了，想看到这些文件的请求在另一个地方：

点击 show console drawer：

![](./images/95e4f4cb223d4a23d991289d684c080e.webp )

打开 developer resources:

![](./images/cfdab425a9722fc1ab1d7edf6aee49d2.webp )

就可以看到所有的 sourcemap 请求了：

![](./images/5c10747ef9214bc97e5eba1d08dd3f81.webp )

只不过这部分做的很简陋，只能看 sourcemap 文件请求成功、失败之类的。

## remove event listeners

element 面板选中元素可以看到这个元素和它的父元素的所有事件监听器：

![](./images/ca84aa05b10a318a2cecc2bf4ec5f013.webp )

可以手动 remove。

比如你想看下拉菜单的样式，但是鼠标一移开就消失了

![](./images/4c37665888637418737a112720317543.webp )

这时候你可以删掉这个按钮的 mouseleave 事件的监听器：

![](./images/a2f0fa400bbff6ab90bd0c1387044e74.webp )

这样移开鼠标也不会消失了：

![](./images/e78413b116dc6ed6e41fc776d0251c0c.webp )

## 

## 总结

这节梳理了比较有用的 Chrome DevTools 小功能，学会这些小功能的使用能提升调试网页的效率。